<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Functions | Best Coding Practices for R</title>
  <meta name="description" content="This book explains the most important things you need to know while you are writing production level R code." />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Functions | Best Coding Practices for R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This book explains the most important things you need to know while you are writing production level R code." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Functions | Best Coding Practices for R" />
  
  <meta name="twitter:description" content="This book explains the most important things you need to know while you are writing production level R code." />
  

<meta name="author" content="Vikram Singh Rawat" />


<meta name="date" content="2021-04-27" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="code.html"/>
<link rel="next" href="names.html"/>
<script src="libs/header-attrs-2.7/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/clipboard-1.7.1/clipboard.min.js"></script>
<link href="libs/primer-tooltips-1.4.0/build.css" rel="stylesheet" />
<link href="libs/klippy-0.0.0.9500/css/klippy.min.css" rel="stylesheet" />
<script src="libs/klippy-0.0.0.9500/js/klippy.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Best Coding Practices for R </a></li>

<li class="divider"></li>
<li class="part"><span><b>I Introduction</b></span></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>CoverPage</a></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="part"><span><b>II Structure</b></span></li>
<li class="chapter" data-level="2" data-path="folder.html"><a href="folder.html"><i class="fa fa-check"></i><b>2</b> Folder Structure</a>
<ul>
<li class="chapter" data-level="2.1" data-path="folder.html"><a href="folder.html#organizing-files"><i class="fa fa-check"></i><b>2.1</b> Organizing files</a></li>
<li class="chapter" data-level="2.2" data-path="folder.html"><a href="folder.html#create-projects"><i class="fa fa-check"></i><b>2.2</b> Create Projects</a></li>
<li class="chapter" data-level="2.3" data-path="folder.html"><a href="folder.html#naming-files"><i class="fa fa-check"></i><b>2.3</b> Naming files</a></li>
<li class="chapter" data-level="2.4" data-path="folder.html"><a href="folder.html#folders-based-on-file-type"><i class="fa fa-check"></i><b>2.4</b> Folders Based on File-Type</a></li>
<li class="chapter" data-level="2.5" data-path="folder.html"><a href="folder.html#creating-sub-folders"><i class="fa fa-check"></i><b>2.5</b> Creating Sub-folders</a></li>
<li class="chapter" data-level="2.6" data-path="folder.html"><a href="folder.html#conclusion"><i class="fa fa-check"></i><b>2.6</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="code.html"><a href="code.html"><i class="fa fa-check"></i><b>3</b> Code Structure</a>
<ul>
<li class="chapter" data-level="3.1" data-path="code.html"><a href="code.html#create-sections"><i class="fa fa-check"></i><b>3.1</b> Create Sections</a></li>
<li class="chapter" data-level="3.2" data-path="code.html"><a href="code.html#order-of-code"><i class="fa fa-check"></i><b>3.2</b> Order of Code</a></li>
<li class="chapter" data-level="3.3" data-path="code.html"><a href="code.html#indentation"><i class="fa fa-check"></i><b>3.3</b> Indentation</a></li>
<li class="chapter" data-level="3.4" data-path="code.html"><a href="code.html#give-your-code-a-breathing-room"><i class="fa fa-check"></i><b>3.4</b> Give your code a breathing room</a></li>
<li class="chapter" data-level="3.5" data-path="code.html"><a href="code.html#conclusion-1"><i class="fa fa-check"></i><b>3.5</b> Conclusion’</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="func.html"><a href="func.html"><i class="fa fa-check"></i><b>4</b> Functions</a>
<ul>
<li class="chapter" data-level="4.1" data-path="func.html"><a href="func.html#metadata-or-information-header"><i class="fa fa-check"></i><b>4.1</b> Metadata or Information header</a></li>
<li class="chapter" data-level="4.2" data-path="func.html"><a href="func.html#pass-everything-through-parameters"><i class="fa fa-check"></i><b>4.2</b> Pass everything through parameters</a></li>
<li class="chapter" data-level="4.3" data-path="func.html"><a href="func.html#use-return-statement"><i class="fa fa-check"></i><b>4.3</b> Use Return Statement</a></li>
<li class="chapter" data-level="4.4" data-path="func.html"><a href="func.html#keep-a-consistency-in-return-type"><i class="fa fa-check"></i><b>4.4</b> Keep a consistency in Return Type</a></li>
<li class="chapter" data-level="4.5" data-path="func.html"><a href="func.html#use-sensible-names-for-parameters-too"><i class="fa fa-check"></i><b>4.5</b> Use Sensible Names for parameters too…</a></li>
<li class="chapter" data-level="4.6" data-path="func.html"><a href="func.html#use-trycatch"><i class="fa fa-check"></i><b>4.6</b> use tryCatch</a></li>
<li class="chapter" data-level="4.7" data-path="func.html"><a href="func.html#write-simple-and-unique-functions"><i class="fa fa-check"></i><b>4.7</b> Write simple and unique functions</a></li>
<li class="chapter" data-level="4.8" data-path="func.html"><a href="func.html#dont-load-libraries-or-source-code-inside-a-function"><i class="fa fa-check"></i><b>4.8</b> Don’t load libraries or source code inside a function</a></li>
<li class="chapter" data-level="4.9" data-path="func.html"><a href="func.html#use-packagefunction-approach"><i class="fa fa-check"></i><b>4.9</b> Use Package::Function() approach</a>
<ul>
<li class="chapter" data-level="4.9.1" data-path="func.html"><a href="func.html#you-should-load-libraries-in-the-order-of-their-usage"><i class="fa fa-check"></i><b>4.9.1</b> You should load libraries in the order of their usage</a></li>
</ul></li>
<li class="chapter" data-level="4.10" data-path="func.html"><a href="func.html#conclusion-2"><i class="fa fa-check"></i><b>4.10</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="names.html"><a href="names.html"><i class="fa fa-check"></i><b>5</b> Naming Conventions</a>
<ul>
<li class="chapter" data-level="5.1" data-path="names.html"><a href="names.html#popular-naming-conventions"><i class="fa fa-check"></i><b>5.1</b> Popular naming conventions</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="names.html"><a href="names.html#camelcase"><i class="fa fa-check"></i><b>5.1.1</b> camelCase</a></li>
<li class="chapter" data-level="5.1.2" data-path="names.html"><a href="names.html#pascalcase"><i class="fa fa-check"></i><b>5.1.2</b> PascalCase</a></li>
<li class="chapter" data-level="5.1.3" data-path="names.html"><a href="names.html#snake_case"><i class="fa fa-check"></i><b>5.1.3</b> snake_case</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="names.html"><a href="names.html#informative-names"><i class="fa fa-check"></i><b>5.2</b> Informative Names</a></li>
<li class="chapter" data-level="5.3" data-path="names.html"><a href="names.html#conclusions"><i class="fa fa-check"></i><b>5.3</b> Conclusions</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="envManagement.html"><a href="envManagement.html"><i class="fa fa-check"></i><b>6</b> Environment Management</a>
<ul>
<li class="chapter" data-level="6.1" data-path="envManagement.html"><a href="envManagement.html#avoid-package-dependencies-when-possible"><i class="fa fa-check"></i><b>6.1</b> Avoid package dependencies when possible</a></li>
<li class="chapter" data-level="6.2" data-path="envManagement.html"><a href="envManagement.html#renv-for-package-management"><i class="fa fa-check"></i><b>6.2</b> renv for package management</a></li>
<li class="chapter" data-level="6.3" data-path="envManagement.html"><a href="envManagement.html#config-for-external-dependencies"><i class="fa fa-check"></i><b>6.3</b> config for external dependencies</a></li>
<li class="chapter" data-level="6.4" data-path="envManagement.html"><a href="envManagement.html#conclusion-3"><i class="fa fa-check"></i><b>6.4</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="dataManagement.html"><a href="dataManagement.html"><i class="fa fa-check"></i><b>7</b> data Management</a>
<ul>
<li class="chapter" data-level="7.1" data-path="dataManagement.html"><a href="dataManagement.html#keep-a-copy-or-your-data"><i class="fa fa-check"></i><b>7.1</b> Keep a Copy or your Data</a></li>
<li class="chapter" data-level="7.2" data-path="dataManagement.html"><a href="dataManagement.html#dont-use-numbers-for-columns"><i class="fa fa-check"></i><b>7.2</b> Don’t use numbers for columns</a></li>
<li class="chapter" data-level="7.3" data-path="dataManagement.html"><a href="dataManagement.html#keep-meaningful-and-proper-column-names"><i class="fa fa-check"></i><b>7.3</b> Keep Meaningful and proper column names</a></li>
<li class="chapter" data-level="7.4" data-path="dataManagement.html"><a href="dataManagement.html#use-databases"><i class="fa fa-check"></i><b>7.4</b> Use Databases</a></li>
<li class="chapter" data-level="7.5" data-path="dataManagement.html"><a href="dataManagement.html#use-efficient-packages"><i class="fa fa-check"></i><b>7.5</b> Use Efficient Packages</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="dataManagement.html"><a href="dataManagement.html#data.table"><i class="fa fa-check"></i><b>7.5.1</b> data.table</a></li>
<li class="chapter" data-level="7.5.2" data-path="dataManagement.html"><a href="dataManagement.html#matrix"><i class="fa fa-check"></i><b>7.5.2</b> Matrix</a></li>
<li class="chapter" data-level="7.5.3" data-path="dataManagement.html"><a href="dataManagement.html#disk.frame"><i class="fa fa-check"></i><b>7.5.3</b> disk.frame</a></li>
<li class="chapter" data-level="7.5.4" data-path="dataManagement.html"><a href="dataManagement.html#modeldb"><i class="fa fa-check"></i><b>7.5.4</b> modeldb</a></li>
<li class="chapter" data-level="7.5.5" data-path="dataManagement.html"><a href="dataManagement.html#dbplot"><i class="fa fa-check"></i><b>7.5.5</b> dbplot</a></li>
<li class="chapter" data-level="7.5.6" data-path="dataManagement.html"><a href="dataManagement.html#sparklyr"><i class="fa fa-check"></i><b>7.5.6</b> sparklyr</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="dataManagement.html"><a href="dataManagement.html#conclusion-4"><i class="fa fa-check"></i><b>7.6</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="debug.html"><a href="debug.html"><i class="fa fa-check"></i><b>8</b> Debugging</a>
<ul>
<li class="chapter" data-level="8.1" data-path="debug.html"><a href="debug.html#write-unit-tests"><i class="fa fa-check"></i><b>8.1</b> Write Unit Tests</a></li>
<li class="chapter" data-level="8.2" data-path="debug.html"><a href="debug.html#browser-and-print-are-your-friend"><i class="fa fa-check"></i><b>8.2</b> Browser() and print() are your friend</a></li>
<li class="chapter" data-level="8.3" data-path="debug.html"><a href="debug.html#read-the-functions"><i class="fa fa-check"></i><b>8.3</b> <strong>Read the functions</strong></a></li>
<li class="chapter" data-level="8.4" data-path="debug.html"><a href="debug.html#version-control-system"><i class="fa fa-check"></i><b>8.4</b> Version Control System</a></li>
<li class="chapter" data-level="8.5" data-path="debug.html"><a href="debug.html#make-small-commits"><i class="fa fa-check"></i><b>8.5</b> Make small commits</a></li>
<li class="chapter" data-level="8.6" data-path="debug.html"><a href="debug.html#use-curly-brackets"><i class="fa fa-check"></i><b>8.6</b> Use curly brackets</a></li>
<li class="chapter" data-level="8.7" data-path="debug.html"><a href="debug.html#always-use-named-parameters"><i class="fa fa-check"></i><b>8.7</b> Always use named parameters</a></li>
<li class="chapter" data-level="8.8" data-path="debug.html"><a href="debug.html#log-the-errors"><i class="fa fa-check"></i><b>8.8</b> Log the errors</a></li>
<li class="chapter" data-level="8.9" data-path="debug.html"><a href="debug.html#dont-use-already-used-names"><i class="fa fa-check"></i><b>8.9</b> Don’t Use already used names</a></li>
<li class="chapter" data-level="8.10" data-path="debug.html"><a href="debug.html#use-simple-code"><i class="fa fa-check"></i><b>8.10</b> Use Simple code</a></li>
<li class="chapter" data-level="8.11" data-path="debug.html"><a href="debug.html#conclusion-5"><i class="fa fa-check"></i><b>8.11</b> Conclusion</a></li>
</ul></li>
<li class="part"><span><b>III Memory</b></span></li>
<li class="chapter" data-level="9" data-path="types.html"><a href="types.html"><i class="fa fa-check"></i><b>9</b> Type System</a>
<ul>
<li class="chapter" data-level="9.1" data-path="types.html"><a href="types.html#things-you-should-know"><i class="fa fa-check"></i><b>9.1</b> Things you should know</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="types.html"><a href="types.html#r-dont-have-scalar-data-types"><i class="fa fa-check"></i><b>9.1.1</b> R don’t have scalar data types</a></li>
<li class="chapter" data-level="9.1.2" data-path="types.html"><a href="types.html#dates-are-basically-integers-under-the-hood."><i class="fa fa-check"></i><b>9.1.2</b> Dates are basically integers under the hood.</a></li>
<li class="chapter" data-level="9.1.3" data-path="types.html"><a href="types.html#posixlt-are-basically-lists-under-the-hood"><i class="fa fa-check"></i><b>9.1.3</b> POSIXlt are basically lists under the hood</a></li>
<li class="chapter" data-level="9.1.4" data-path="types.html"><a href="types.html#integers-are-smaller-than-numeric"><i class="fa fa-check"></i><b>9.1.4</b> Integers are smaller than numeric</a></li>
<li class="chapter" data-level="9.1.5" data-path="types.html"><a href="types.html#define-your-datatypes-before-the-variable"><i class="fa fa-check"></i><b>9.1.5</b> define your datatypes before the variable</a></li>
<li class="chapter" data-level="9.1.6" data-path="types.html"><a href="types.html#lists-are-better-than-dataframe-under-a-loop"><i class="fa fa-check"></i><b>9.1.6</b> lists are better than dataframe under a loop</a></li>
<li class="chapter" data-level="9.1.7" data-path="types.html"><a href="types.html#use-lists-whenever-possible"><i class="fa fa-check"></i><b>9.1.7</b> use lists whenever possible</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="types.html"><a href="types.html#choose-data-types-carefully"><i class="fa fa-check"></i><b>9.2</b> Choose data types carefully</a></li>
<li class="chapter" data-level="9.3" data-path="types.html"><a href="types.html#dont-change-datatypes"><i class="fa fa-check"></i><b>9.3</b> don’t change datatypes</a></li>
<li class="chapter" data-level="9.4" data-path="types.html"><a href="types.html#future-of-type-system-in-r"><i class="fa fa-check"></i><b>9.4</b> Future of type-system in R</a></li>
<li class="chapter" data-level="9.5" data-path="types.html"><a href="types.html#conclusion-6"><i class="fa fa-check"></i><b>9.5</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="reference.html"><a href="reference.html"><i class="fa fa-check"></i><b>10</b> Pass By Value-Reference</a>
<ul>
<li class="chapter" data-level="10.1" data-path="reference.html"><a href="reference.html#understanding-the-system"><i class="fa fa-check"></i><b>10.1</b> Understanding the system</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="reference.html"><a href="reference.html#pass-by-value"><i class="fa fa-check"></i><b>10.1.1</b> Pass by Value</a></li>
<li class="chapter" data-level="10.1.2" data-path="reference.html"><a href="reference.html#pass-by-reference"><i class="fa fa-check"></i><b>10.1.2</b> Pass by reference</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="reference.html"><a href="reference.html#copy-on-modify"><i class="fa fa-check"></i><b>10.2</b> Copy on modify</a></li>
<li class="chapter" data-level="10.3" data-path="reference.html"><a href="reference.html#for-pass-by-reference"><i class="fa fa-check"></i><b>10.3</b> for pass by reference</a></li>
<li class="chapter" data-level="10.4" data-path="reference.html"><a href="reference.html#conclusion-7"><i class="fa fa-check"></i><b>10.4</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="releasememory.html"><a href="releasememory.html"><i class="fa fa-check"></i><b>11</b> Release Memory</a>
<ul>
<li class="chapter" data-level="11.1" data-path="releasememory.html"><a href="releasememory.html#use-rm"><i class="fa fa-check"></i><b>11.1</b> use rm()</a></li>
<li class="chapter" data-level="11.2" data-path="releasememory.html"><a href="releasememory.html#use-gc"><i class="fa fa-check"></i><b>11.2</b> use gc()</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="releasememory.html"><a href="releasememory.html#r-version-3.5"><i class="fa fa-check"></i><b>11.2.1</b> R version 3.5</a></li>
<li class="chapter" data-level="11.2.2" data-path="releasememory.html"><a href="releasememory.html#r-version-4.0"><i class="fa fa-check"></i><b>11.2.2</b> R version 4.0</a></li>
<li class="chapter" data-level="11.2.3" data-path="releasememory.html"><a href="releasememory.html#inside-a-heavy-loop"><i class="fa fa-check"></i><b>11.2.3</b> Inside a heavy loop</a></li>
<li class="chapter" data-level="11.2.4" data-path="releasememory.html"><a href="releasememory.html#anything-that-takes-more-than-30-seconds"><i class="fa fa-check"></i><b>11.2.4</b> anything that takes more than 30 seconds</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="releasememory.html"><a href="releasememory.html#cache-store-calculations"><i class="fa fa-check"></i><b>11.3</b> Cache / Store calculations</a></li>
<li class="chapter" data-level="11.4" data-path="releasememory.html"><a href="releasememory.html#conclusion-8"><i class="fa fa-check"></i><b>11.4</b> Conclusion</a></li>
</ul></li>
<li class="part"><span><b>IV Speed</b></span></li>
<li class="chapter" data-level="12" data-path="speedtips.html"><a href="speedtips.html"><i class="fa fa-check"></i><b>12</b> Some Tips to make R code faster</a>
<ul>
<li class="chapter" data-level="12.1" data-path="speedtips.html"><a href="speedtips.html#use-latest-version-of-r"><i class="fa fa-check"></i><b>12.1</b> Use Latest version of R</a></li>
<li class="chapter" data-level="12.2" data-path="speedtips.html"><a href="speedtips.html#benchmark-and-profiling-the-code"><i class="fa fa-check"></i><b>12.2</b> Benchmark and profiling the code</a></li>
<li class="chapter" data-level="12.3" data-path="speedtips.html"><a href="speedtips.html#algorithm-matters-more-than-language"><i class="fa fa-check"></i><b>12.3</b> Algorithm matters more than language</a></li>
<li class="chapter" data-level="12.4" data-path="speedtips.html"><a href="speedtips.html#read-the-function"><i class="fa fa-check"></i><b>12.4</b> Read the function</a></li>
<li class="chapter" data-level="12.5" data-path="speedtips.html"><a href="speedtips.html#use-conditionals-to-break-computations"><i class="fa fa-check"></i><b>12.5</b> Use Conditionals to break computations</a></li>
<li class="chapter" data-level="12.6" data-path="speedtips.html"><a href="speedtips.html#use-faster-packages"><i class="fa fa-check"></i><b>12.6</b> Use Faster packages</a></li>
<li class="chapter" data-level="12.7" data-path="speedtips.html"><a href="speedtips.html#some-pointers"><i class="fa fa-check"></i><b>12.7</b> Some pointers</a>
<ul>
<li class="chapter" data-level="12.7.1" data-path="speedtips.html"><a href="speedtips.html#use-instead-of-when-you-can"><i class="fa fa-check"></i><b>12.7.1</b> use [[ instead of [ when you can</a></li>
<li class="chapter" data-level="12.7.2" data-path="speedtips.html"><a href="speedtips.html#r-calculates-everything"><i class="fa fa-check"></i><b>12.7.2</b> R calculates everything</a></li>
<li class="chapter" data-level="12.7.3" data-path="speedtips.html"><a href="speedtips.html#internal-functions"><i class="fa fa-check"></i><b>12.7.3</b> .Internal functions</a></li>
<li class="chapter" data-level="12.7.4" data-path="speedtips.html"><a href="speedtips.html#dont-compile"><i class="fa fa-check"></i><b>12.7.4</b> Don’t Compile</a></li>
<li class="chapter" data-level="12.7.5" data-path="speedtips.html"><a href="speedtips.html#use-direct-method.object-structure"><i class="fa fa-check"></i><b>12.7.5</b> use direct method.object structure</a></li>
</ul></li>
<li class="chapter" data-level="12.8" data-path="speedtips.html"><a href="speedtips.html#export-other-languages"><i class="fa fa-check"></i><b>12.8</b> Export Other languages</a></li>
<li class="chapter" data-level="12.9" data-path="speedtips.html"><a href="speedtips.html#conclusion-9"><i class="fa fa-check"></i><b>12.9</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="loops.html"><a href="loops.html"><i class="fa fa-check"></i><b>13</b> For Loops</a>
<ul>
<li class="chapter" data-level="13.1" data-path="loops.html"><a href="loops.html#initialize-objects-before-loops"><i class="fa fa-check"></i><b>13.1</b> initialize objects before loops</a></li>
<li class="chapter" data-level="13.2" data-path="loops.html"><a href="loops.html#use-simple-data-types"><i class="fa fa-check"></i><b>13.2</b> use simple data-types</a></li>
<li class="chapter" data-level="13.3" data-path="loops.html"><a href="loops.html#apply-family"><i class="fa fa-check"></i><b>13.3</b> apply family</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="loops.html"><a href="loops.html#apply-functions-are-not-much-faster-than-loops"><i class="fa fa-check"></i><b>13.3.1</b> apply functions are not much faster than loops</a></li>
<li class="chapter" data-level="13.3.2" data-path="loops.html"><a href="loops.html#nested-lapply-have-same-speed-as-a-normal-lapply"><i class="fa fa-check"></i><b>13.3.2</b> Nested lapply have same speed as a normal lapply</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="loops.html"><a href="loops.html#vectorize-your-code"><i class="fa fa-check"></i><b>13.4</b> Vectorize your code</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="loops.html"><a href="loops.html#never-repeat-a-calculation"><i class="fa fa-check"></i><b>13.4.1</b> never repeat a calculation</a></li>
<li class="chapter" data-level="13.4.2" data-path="loops.html"><a href="loops.html#vectorized-code-can-do-2-or-3-steps-more-in-lesser-time"><i class="fa fa-check"></i><b>13.4.2</b> Vectorized code can do 2 or 3 steps more in lesser time</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="loops.html"><a href="loops.html#understanding-non-vectorized-code"><i class="fa fa-check"></i><b>13.5</b> Understanding non-vectorized code</a></li>
<li class="chapter" data-level="13.6" data-path="loops.html"><a href="loops.html#do-as-little-as-possible-inside-a-loop"><i class="fa fa-check"></i><b>13.6</b> Do as little as possible inside a loop</a>
<ul>
<li class="chapter" data-level="13.6.1" data-path="loops.html"><a href="loops.html#combine-vectorized-code-inside-a-loop"><i class="fa fa-check"></i><b>13.6.1</b> Combine Vectorized code inside a loop</a></li>
</ul></li>
<li class="chapter" data-level="13.7" data-path="loops.html"><a href="loops.html#conclusion-10"><i class="fa fa-check"></i><b>13.7</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="multithreading.html"><a href="multithreading.html"><i class="fa fa-check"></i><b>14</b> Multithreading</a></li>
<li class="part"><span><b>V Shiny Tips</b></span></li>
<li class="chapter" data-level="15" data-path="shinyspeed.html"><a href="shinyspeed.html"><i class="fa fa-check"></i><b>15</b> Speed</a></li>
<li class="chapter" data-level="16" data-path="shinymemory.html"><a href="shinymemory.html"><i class="fa fa-check"></i><b>16</b> Memory</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Best Coding Practices for R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="func" class="section level1" number="4">
<h1><span class="header-section-number">Chapter 4</span> Functions</h1>
<p>I can not over emphasize the importance of functions. As a data scientist most of the time you will be writing functions. Only in couple of cases where you have to write complicated classes there too methods are nothing more than functions. Having solid grasp of best practices in functions is a must for everybody working in any language what-so-ever. Hopefully this chapter will help you in best coding practices for functions.</p>
<div id="metadata-or-information-header" class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> Metadata or Information header</h2>
<p>As I mentioned in the previous chapter it is a good practice to create sections for everything you do in R. functions are no exception to the rule. But along with that there are a couple of information you should write along with the function.</p>
<p>I worked in a few MNC where we had to write metadata of every function before writing it down. It makes it easier for code-reviewer to understand you code and for the entire team to collaborate in the project. It’s good for personal projects too… Let me give you an example of what I mean by this.</p>
<div class="figure">
<img src="figures/scrn_functions_metadata.jpg" alt="" />
<p class="caption">functions metadata</p>
</div>
<p>You can see that if you are working on large teams or may be in big corporate settings where anybody can be reassigned to a different project. This data helps by identifying who wrote what and why.</p>
<p>Examples of some important tags can be :</p>
<ol style="list-style-type: decimal">
<li>written by</li>
<li>written on</li>
<li>parameters</li>
<li>modified by</li>
<li>modified on</li>
<li>purpose</li>
<li>descriptions</li>
</ol>
<p>You can create your own tags based on usecases and information needed for further scenarios.</p>
</div>
<div id="pass-everything-through-parameters" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Pass everything through parameters</h2>
<p>I have seen people writing functions with calling things from global environments. Take a look at the code below.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="func.html#cb19-1" aria-hidden="true" tabindex="-1"></a>foo <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb19-2"><a href="func.html#cb19-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">return</span>( x <span class="sc">+</span> y)</span>
<span id="cb19-3"><a href="func.html#cb19-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb19-4"><a href="func.html#cb19-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-5"><a href="func.html#cb19-5" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb19-6"><a href="func.html#cb19-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-7"><a href="func.html#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="fu">foo</span>(<span class="dv">5</span>)</span></code></pre></div>
<pre><code>## [1] 15</code></pre>
<p>Here the value of <em>foo</em> is based on y which is not a part of the function instead it’s in global environment and function always have to search global environment for the object. consider these scenarios:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="func.html#cb21-1" aria-hidden="true" tabindex="-1"></a>bar <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y){</span>
<span id="cb21-2"><a href="func.html#cb21-2" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> y</span>
<span id="cb21-3"><a href="func.html#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(</span>
<span id="cb21-4"><a href="func.html#cb21-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">foo</span>(x)</span>
<span id="cb21-5"><a href="func.html#cb21-5" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb21-6"><a href="func.html#cb21-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb21-7"><a href="func.html#cb21-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-8"><a href="func.html#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="fu">bar</span>(<span class="dv">5</span>, <span class="dv">20</span>)</span></code></pre></div>
<pre><code>## [1] 15</code></pre>
<p>you would assume that the answer is 25 but it’s 15 because foo was created in the global environment and it will always look up value in global environment before anything else. This is called <strong>Lexical Scoping</strong> it’s okay if you don’t know it. It is very confusing and could mess up your code at any point in time. I am an experienced R programmer I too have trouble getting my head around it.</p>
<p>We can avoid all these situations by following the best coding practices that have been used in software industries for years. <strong>Function should be a self contained code</strong> which shouldn’t be impacted by the outer world. Only is certain scenarios you allow to deviate from these rules but it’s a good coding practice none the less. now in the above example instead of relying on the global variable if I just had created a parameter for Y, my code would be simpler to write and easier to understand and I would not have to think about lexical scoping on every step.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="func.html#cb23-1" aria-hidden="true" tabindex="-1"></a>foo <span class="ot">&lt;-</span> <span class="cf">function</span>( x, y ){</span>
<span id="cb23-2"><a href="func.html#cb23-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">return</span>( x <span class="sc">+</span> y )</span>
<span id="cb23-3"><a href="func.html#cb23-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb23-4"><a href="func.html#cb23-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-5"><a href="func.html#cb23-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-6"><a href="func.html#cb23-6" aria-hidden="true" tabindex="-1"></a>bar <span class="ot">&lt;-</span> <span class="cf">function</span>( x, y ){</span>
<span id="cb23-7"><a href="func.html#cb23-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(</span>
<span id="cb23-8"><a href="func.html#cb23-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">foo</span>( x, y )    </span>
<span id="cb23-9"><a href="func.html#cb23-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb23-10"><a href="func.html#cb23-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb23-11"><a href="func.html#cb23-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-12"><a href="func.html#cb23-12" aria-hidden="true" tabindex="-1"></a><span class="fu">bar</span>(<span class="dv">5</span>, <span class="dv">20</span>)</span></code></pre></div>
<pre><code>## [1] 25</code></pre>
<p>Now this code returns 25 as we all expected and trust me the Y is still available in global environment but that doesn’t impact the foo or bar at all. Now you can nest this function under multiple other functions and it will behave exactly like it should.</p>
<p>There is a golden rule you should take away from this section. <strong>Avoid Global Variables at all costs</strong>. As much as possible pass everything through the parameters. That what they are for right !!!</p>
</div>
<div id="use-return-statement" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Use Return Statement</h2>
<p>It is a very simple thing yet most of the R users never worry about it because R takes care of finer details for you. But return statements actually make your code easier to read.</p>
<p>Suppose you have to review code return statement makes it easier to glance at the code and understand what is it doing. Almost all the programming languages are habitual with it. There are no good advantage I can tell you for a return statement other than readability. But just by following these practices R community as a whole could get more respect in programming community. So please use Return statements wherever possible. In Big MNC your code will never pass reviewer unless it has return statements.</p>
<p>It also is good for functions that don’t return anything you can just return true or false depending on the fact that the function ran without producing any error. Functions where you modify a data.table or where you change something in the database etc… It’s a standard practice in old programming languages like C++ and it’s a good practice indeed. We as a community should embrace these practices which will help us down the road.</p>
</div>
<div id="keep-a-consistency-in-return-type" class="section level2" number="4.4">
<h2><span class="header-section-number">4.4</span> Keep a consistency in Return Type</h2>
<p><strong>Return type of a function should be consistent regardless of what happens in a code.</strong> You may assume this is so simple that it goes without saying who would in their sane mind return character vector instead of a numerical one and you would be right. But Things get complicated when people start to work in composite data types like <strong>Lists and Dataframes</strong>.</p>
<p>Working with lists people get confused and forget this basic principle. I have seen function returning list of 2 elements on some conditions and 3 on other and 4 on some more. It makes it harder for users to work on those return values.</p>
<p>Don’t even get me started on dataframes. People write functions that do some magic stuff on dataframes and it sometimes return a dataframe of 10 columns, sometime 11 and sometime 8. It’s such a common mistake to make. I understand if you are fetching a table from database and returning that same table via functions but during manipulations you must add empty columns or delete existing ones to make it consistent for the end user regardless of the conditions you have in the functions.</p>
</div>
<div id="use-sensible-names-for-parameters-too" class="section level2" number="4.5">
<h2><span class="header-section-number">4.5</span> Use Sensible Names for parameters too…</h2>
<p>Yet another simple thing but because most of us including me come from non computer science background we have a tendency to use names like <strong>x, y, z, beta, theta, gamma, string etc…</strong> in our function parameters. I too am guilty of doing it in above code for foo and bar functions and in general. Many good and well established libraries in R are guilty of this sin too… But in long run these words don’t make much sense. It’s hard to maintain that code and it’s hard for user as well. Let’s take an example :</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="func.html#cb25-1" aria-hidden="true" tabindex="-1"></a>join <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) x <span class="sc">+</span> y</span>
<span id="cb25-2"><a href="func.html#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="func.html#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="fu">join</span>(<span class="at">x =</span> <span class="dv">12</span>, <span class="at">y =</span> <span class="dv">12</span>)</span></code></pre></div>
<pre><code>## [1] 24</code></pre>
<p>do you see that as a user who hasn’t written or even looked at the code it’s already hard for him to understand what does x and y stands for. Only to get an error like this.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="func.html#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">join</span>(<span class="at">x =</span> <span class="st">&quot;mtcars&quot;</span>, <span class="at">y =</span> <span class="st">&quot;iris&quot;</span>)</span></code></pre></div>
<pre><code>## Error in x + y: non-numeric argument to binary operator</code></pre>
<p>I know it is a stupid example but I see it every time in real code. When you only need numeric values why not include that information in the parameter name. something like:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="func.html#cb29-1" aria-hidden="true" tabindex="-1"></a>join <span class="ot">&lt;-</span> <span class="cf">function</span>(num_x, num_y) num_x <span class="sc">+</span> num_y</span></code></pre></div>
<p>It may not seem like much but this small change makes the life of the user so much better where he doesn’t need to consult the documentation again and again. Their are other ways you can come up with sensible names in your code just to avoid this issue. It’s a standard practice during code review to check the names and these names are never allowed in production environment. We will discuss more about names in another chapter but for now understand that parameter names are just as important as the name of the function and it should be meaningful and easier to understand. There should be some information buried in the name.</p>
</div>
<div id="use-trycatch" class="section level2" number="4.6">
<h2><span class="header-section-number">4.6</span> use tryCatch</h2>
<p>During deployment we would not like the shiny app or rest api or the chron job to fail. It’s not a good experience to have for either the developer or the client. Best way to avoid it is wrap every function in a tryCatch block and log the errors. This way if you app has some bugs ( which every app does ). It will not crash and not destroy the experience of all the other people using it.</p>
<p>Let’s bring back the foo function :</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="func.html#cb30-1" aria-hidden="true" tabindex="-1"></a>foo <span class="ot">&lt;-</span> <span class="cf">function</span>( x, y ){</span>
<span id="cb30-2"><a href="func.html#cb30-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">tryCatch</span>(</span>
<span id="cb30-3"><a href="func.html#cb30-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">expr =</span> {</span>
<span id="cb30-4"><a href="func.html#cb30-4" aria-hidden="true" tabindex="-1"></a>       <span class="fu">return</span>( x <span class="sc">+</span> y )</span>
<span id="cb30-5"><a href="func.html#cb30-5" aria-hidden="true" tabindex="-1"></a>     },</span>
<span id="cb30-6"><a href="func.html#cb30-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">error =</span> <span class="cf">function</span>(e){</span>
<span id="cb30-7"><a href="func.html#cb30-7" aria-hidden="true" tabindex="-1"></a>       <span class="fu">print</span>(</span>
<span id="cb30-8"><a href="func.html#cb30-8" aria-hidden="true" tabindex="-1"></a>         <span class="fu">sprintf</span>(<span class="st">&quot;An error occurred in foo at %s : %s&quot;</span>,</span>
<span id="cb30-9"><a href="func.html#cb30-9" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">Sys.time</span>(),</span>
<span id="cb30-10"><a href="func.html#cb30-10" aria-hidden="true" tabindex="-1"></a>                 e)</span>
<span id="cb30-11"><a href="func.html#cb30-11" aria-hidden="true" tabindex="-1"></a>         )</span>
<span id="cb30-12"><a href="func.html#cb30-12" aria-hidden="true" tabindex="-1"></a>     })</span>
<span id="cb30-13"><a href="func.html#cb30-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb30-14"><a href="func.html#cb30-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-15"><a href="func.html#cb30-15" aria-hidden="true" tabindex="-1"></a><span class="fu">foo</span>(<span class="st">&quot;mtcars&quot;</span>, <span class="st">&quot;iris&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;An error occurred in foo at 2021-04-27 16:25:59 : Error in x + y: non-numeric argument to binary operator\n&quot;</code></pre>
<p>Now imagine this line to be printed in a json file or inserted in a database with time stamp and other information instead of crashing the entire code only a particular functionality will not run which is huge. This is the difference between staying late on Saturday night to fix a bug vs telling them that I will fix it on Monday. To me that is big enough.</p>
</div>
<div id="write-simple-and-unique-functions" class="section level2" number="4.7">
<h2><span class="header-section-number">4.7</span> Write simple and unique functions</h2>
<p><strong>Task of one function should be to do one thing and one thing only</strong>. There are numerous times when people assume they have written excellent code because everything is in a function.</p>
<p>Purpose of a function is to reduce one unique task in a single line. If your function does multiple things then it’s a good Idea to <strong><em>Break your function into multiple one and then create a function which uses all of them</em></strong>.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="func.html#cb32-1" aria-hidden="true" tabindex="-1"></a>average_func <span class="ot">&lt;-</span> <span class="cf">function</span>( mult_params ){</span>
<span id="cb32-2"><a href="func.html#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tryCatch</span>(</span>
<span id="cb32-3"><a href="func.html#cb32-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">expr =</span> {</span>
<span id="cb32-4"><a href="func.html#cb32-4" aria-hidden="true" tabindex="-1"></a>      <span class="do">###</span></span>
<span id="cb32-5"><a href="func.html#cb32-5" aria-hidden="true" tabindex="-1"></a>      <span class="co"># code to do stuff 1</span></span>
<span id="cb32-6"><a href="func.html#cb32-6" aria-hidden="true" tabindex="-1"></a>      <span class="do">###</span></span>
<span id="cb32-7"><a href="func.html#cb32-7" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb32-8"><a href="func.html#cb32-8" aria-hidden="true" tabindex="-1"></a>      <span class="do">###</span></span>
<span id="cb32-9"><a href="func.html#cb32-9" aria-hidden="true" tabindex="-1"></a>      <span class="co"># code to do stuff 2</span></span>
<span id="cb32-10"><a href="func.html#cb32-10" aria-hidden="true" tabindex="-1"></a>      <span class="do">###</span></span>
<span id="cb32-11"><a href="func.html#cb32-11" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb32-12"><a href="func.html#cb32-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">error =</span> <span class="cf">function</span>(e){</span>
<span id="cb32-13"><a href="func.html#cb32-13" aria-hidden="true" tabindex="-1"></a>      <span class="do">###</span></span>
<span id="cb32-14"><a href="func.html#cb32-14" aria-hidden="true" tabindex="-1"></a>      <span class="co"># code to log errors</span></span>
<span id="cb32-15"><a href="func.html#cb32-15" aria-hidden="true" tabindex="-1"></a>      <span class="do">###</span></span>
<span id="cb32-16"><a href="func.html#cb32-16" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb32-17"><a href="func.html#cb32-17" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Now imagine if today you are logging on a json file and tomorrow client wants to log it into a database. Changing it on every function is not only time consuming but dangerous in terms that now you can break the code.</p>
<p>Now compare that to this code.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="func.html#cb33-1" aria-hidden="true" tabindex="-1"></a>stuff_1 <span class="ot">&lt;-</span> <span class="cf">function</span>(params_1){</span>
<span id="cb33-2"><a href="func.html#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="do">###</span></span>
<span id="cb33-3"><a href="func.html#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># code to do stuff 1</span></span>
<span id="cb33-4"><a href="func.html#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="do">###</span></span>
<span id="cb33-5"><a href="func.html#cb33-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb33-6"><a href="func.html#cb33-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-7"><a href="func.html#cb33-7" aria-hidden="true" tabindex="-1"></a>stuff_2 <span class="ot">&lt;-</span> <span class="cf">function</span>(params_2){</span>
<span id="cb33-8"><a href="func.html#cb33-8" aria-hidden="true" tabindex="-1"></a>  <span class="do">###</span></span>
<span id="cb33-9"><a href="func.html#cb33-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># code to do stuff 1</span></span>
<span id="cb33-10"><a href="func.html#cb33-10" aria-hidden="true" tabindex="-1"></a>  <span class="do">###</span></span>
<span id="cb33-11"><a href="func.html#cb33-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb33-12"><a href="func.html#cb33-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-13"><a href="func.html#cb33-13" aria-hidden="true" tabindex="-1"></a>log_func <span class="ot">&lt;-</span> <span class="cf">function</span>( log_params){</span>
<span id="cb33-14"><a href="func.html#cb33-14" aria-hidden="true" tabindex="-1"></a>  <span class="do">###</span></span>
<span id="cb33-15"><a href="func.html#cb33-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># code to log errors</span></span>
<span id="cb33-16"><a href="func.html#cb33-16" aria-hidden="true" tabindex="-1"></a>  <span class="do">###</span></span>
<span id="cb33-17"><a href="func.html#cb33-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb33-18"><a href="func.html#cb33-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-19"><a href="func.html#cb33-19" aria-hidden="true" tabindex="-1"></a>best_func <span class="ot">&lt;-</span> <span class="cf">function</span>( mult_params ){</span>
<span id="cb33-20"><a href="func.html#cb33-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tryCatch</span>(</span>
<span id="cb33-21"><a href="func.html#cb33-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">expr =</span> {</span>
<span id="cb33-22"><a href="func.html#cb33-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stuff_1</span>()</span>
<span id="cb33-23"><a href="func.html#cb33-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stuff_2</span>()</span>
<span id="cb33-24"><a href="func.html#cb33-24" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb33-25"><a href="func.html#cb33-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">error =</span> <span class="cf">function</span>(e){</span>
<span id="cb33-26"><a href="func.html#cb33-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">log_func</span>()</span>
<span id="cb33-27"><a href="func.html#cb33-27" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb33-28"><a href="func.html#cb33-28" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Here in this code every function has a clear responsibility and the main function is just a composite of multiple unique functions and it will be very easy to debug this code or change the functionality entirely.</p>
</div>
<div id="dont-load-libraries-or-source-code-inside-a-function" class="section level2" number="4.8">
<h2><span class="header-section-number">4.8</span> Don’t load libraries or source code inside a function</h2>
<p>You may assume nobody does it. But I have seen people doing it times and times again.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="func.html#cb34-1" aria-hidden="true" tabindex="-1"></a>foo <span class="ot">&lt;-</span> <span class="cf">function</span>( x ){</span>
<span id="cb34-2"><a href="func.html#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(data.table)</span>
<span id="cb34-3"><a href="func.html#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">setDT</span>(x)</span>
<span id="cb34-4"><a href="func.html#cb34-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb34-5"><a href="func.html#cb34-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-6"><a href="func.html#cb34-6" aria-hidden="true" tabindex="-1"></a>bar <span class="ot">&lt;-</span> <span class="cf">function</span>( x ){</span>
<span id="cb34-7"><a href="func.html#cb34-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">source</span>(<span class="at">file =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb34-8"><a href="func.html#cb34-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>In functional programming terminology these functions are called <code>impure functions</code> . Function which change the global environment or some persistent changes are called impure functions. They require very delicate handling of the entire project. If I don’t know how many packages and what version of them am I dependent on or what files have I loaded in my environment it makes debugging the code a lot more harder.</p>
<p>By following this style of code you are making the debugging harder for your project. In fact I would argue that you should remove all the external dependencies from a function. Take this code for example.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="func.html#cb35-1" aria-hidden="true" tabindex="-1"></a>foo <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb35-2"><a href="func.html#cb35-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb35-3"><a href="func.html#cb35-3" aria-hidden="true" tabindex="-1"></a>  exl <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="at">path =</span> <span class="st">&quot;increased/external/dependency&quot;</span>)</span>
<span id="cb35-4"><a href="func.html#cb35-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-5"><a href="func.html#cb35-5" aria-hidden="true" tabindex="-1"></a>  <span class="do">##  </span></span>
<span id="cb35-6"><a href="func.html#cb35-6" aria-hidden="true" tabindex="-1"></a>  <span class="do">### do some data operation in the function</span></span>
<span id="cb35-7"><a href="func.html#cb35-7" aria-hidden="true" tabindex="-1"></a>  <span class="do">##</span></span>
<span id="cb35-8"><a href="func.html#cb35-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb35-9"><a href="func.html#cb35-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(exl)</span>
<span id="cb35-10"><a href="func.html#cb35-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb35-11"><a href="func.html#cb35-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-12"><a href="func.html#cb35-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-13"><a href="func.html#cb35-13" aria-hidden="true" tabindex="-1"></a>bar <span class="ot">&lt;-</span> <span class="cf">function</span>(</span>
<span id="cb35-14"><a href="func.html#cb35-14" aria-hidden="true" tabindex="-1"></a>  x,</span>
<span id="cb35-15"><a href="func.html#cb35-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">filepath =</span> <span class="st">&quot;increased/external/dependency&quot;</span>){</span>
<span id="cb35-16"><a href="func.html#cb35-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb35-17"><a href="func.html#cb35-17" aria-hidden="true" tabindex="-1"></a>  exl <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="at">path =</span> filepath)</span>
<span id="cb35-18"><a href="func.html#cb35-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-19"><a href="func.html#cb35-19" aria-hidden="true" tabindex="-1"></a>  <span class="do">##  </span></span>
<span id="cb35-20"><a href="func.html#cb35-20" aria-hidden="true" tabindex="-1"></a>  <span class="do">### do some data operation in the function</span></span>
<span id="cb35-21"><a href="func.html#cb35-21" aria-hidden="true" tabindex="-1"></a>  <span class="do">##</span></span>
<span id="cb35-22"><a href="func.html#cb35-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb35-23"><a href="func.html#cb35-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(exl)</span>
<span id="cb35-24"><a href="func.html#cb35-24" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Foo and bar are both doing the same thing and both are relying on an external path for code to work. But because bar is clearly stating the filepath as an argument it is easier to change and adapt to new needs.</p>
<p>If you still need to rely on a package call it from the main script not from a function. And if you absolutely need some functions of a package inside a particular function then use <code>qualified imports</code> and don’t load the entire package.</p>
</div>
<div id="use-packagefunction-approach" class="section level2" number="4.9">
<h2><span class="header-section-number">4.9</span> Use Package::Function() approach</h2>
<p>R classes work differently than the traditional oops we all are aware of. Instead of <code>object_of_class.Method</code> syntax like other programmings have, we in R use <code>method( object_of_class )</code> syntax. Where just by changing name collision is a pretty common thing.</p>
<p>It’s a pretty common thing in R that 2 packages use same function name for different operations. So It’s always better to use <code>qualified imports</code> fancy name for mentioning which package does the function comes from.</p>
<div id="you-should-load-libraries-in-the-order-of-their-usage" class="section level3" number="4.9.1">
<h3><span class="header-section-number">4.9.1</span> You should load libraries in the order of their usage</h3>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="func.html#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># library(&quot;not_used_much&quot;)</span></span>
<span id="cb36-2"><a href="func.html#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="co"># library(&quot;least_used&quot;)</span></span>
<span id="cb36-3"><a href="func.html#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="co"># library(&quot;fairly_used&quot;)</span></span>
<span id="cb36-4"><a href="func.html#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="co"># library(&quot;most_used&quot;)</span></span>
<span id="cb36-5"><a href="func.html#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="co"># library(&quot;cant_do_without_it&quot;)</span></span></code></pre></div>
<p>R uses the loading sequence to identify which function to give preference. It’s usually to the last package loaded. It’s called masking and it’s not a reliable technique but it’s better to arrange your code in that order for sake of simplicity.</p>
<p>and Yes do not forget to mention the package name clearly. like prefer writing this always:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="func.html#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># dplyr::filter()</span></span>
<span id="cb37-2"><a href="func.html#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="co"># stats::filter()</span></span>
<span id="cb37-3"><a href="func.html#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb37-4"><a href="func.html#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="co"># ## instead of </span></span>
<span id="cb37-5"><a href="func.html#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb37-6"><a href="func.html#cb37-6" aria-hidden="true" tabindex="-1"></a><span class="co"># filter()</span></span></code></pre></div>
<p>For your small project this might not be a big deal but when multiple people are working on a code everybody might not be familiar with the packages you are using and they might not know that there is a naming collision between 2 functions. It’s a best practice to explicitly tell R that this function comes from this package. It saves a lot of your time and for the person who is going to maintain your code too… And it makes your debug experience a little better.</p>
</div>
</div>
<div id="conclusion-2" class="section level2" number="4.10">
<h2><span class="header-section-number">4.10</span> Conclusion</h2>
<p>In this chapter we discussed the best practices for writing functions in R. Here are the key takeaways from the chapter.</p>
<ol style="list-style-type: decimal">
<li>write information about the function at top of it.</li>
<li>avoid global variable and pass everything through parameters</li>
<li>use return statement to end your function</li>
<li>keep consistency in return types of a function</li>
<li>use logical names for parameter</li>
<li>use tryCatch in every function</li>
<li>functions are supposed to do one thing and one thing only</li>
<li>don’t try to change global environment without letting the user know</li>
<li>Use qualified imports with syntax package::functions every time possible</li>
</ol>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="code.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="names.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/vikram-rawat/Best_R_Practices/blob/master/02-struct_03_functions.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["best_r_practices.pdf", "best_r_practices.epub"],
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
